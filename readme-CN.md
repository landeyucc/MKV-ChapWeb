# MKV ChapWeb工具文档
文档语言 [English](readme.md) | [简体中文](readme-CN.md)
## 前言

3月初，个人有需求生成 MKV 章节文件，但是找了半天支持直接编辑章节文件的软件少之又少，好不容易找到了软件界面还是上古时代的风格。于是本人自己花费时间使用纯静态前端语言进行编写了此工具，命名为MKV ChapWeb.

## 简介

MKV ChapWeb 是一款 MKV 视频格式章节生成工具，能够帮助用户快速生成、编辑与管理视频文件中的章节信息。通过直观的网页界面与便捷性，用户可以快速设置视频的章节数量、章节名称、开始与结束时间等基础参数，并生成与导出符合 MKV 格式规范的章节标签 XML 文件，方便在支持 MKV 视频的播放器内实现精准的章节导航。

## 使用方法
此工具没有什么复杂的参数，所以使用也是非常简单。仅限于日常的场景使用，所以没有比较冷门的参数标签。

### 工具的界面布局
  * **响应式布局** ：MKV ChapWeb界面使用现代化风格，适配PC与移动端设备，支持读取系统浅色模式与深色模式进行动态设置，支持中英文双语界面，在加载索引页时智能从浏览器获取语言并跳转至对应语言页面，省去了语言不互通而使用浏览器翻译的问题。
  * **侧边栏参数块** ：打开MKV ChapWeb在线网站或者启动MKV ChapWeb离线工具启动后，主界面侧边栏会根据默认章节数量动态生成参数块，每个块包含章节名称、开始时间、结束时间等输入项，用户可直接在对应输入框中填写或修改章节信息。
  * **主控参数区** ：位于页面主体部分，包含视频章节数量、语言标签等关键参数设置项，修改这些参数后，点击相关按钮可触发相应操作，部分操作会动态生成，如生成章节标签、更新侧边栏参数块等，需要注意的是修改此处数据会刷新并清除侧边栏已输入的信息，所以请在设置完此处再进行下一步。
  * **操作按钮** ：“生成章节标签” 按钮用于依据当前设置生成 XML 格式的章节标签文件；“上传 XML” 和 “下载 XML” 按钮分别用于导入已有章节信息文件，方便数据临时导出后可上传继续进行编辑与导出当前生成的章节标签文件，此按钮可直接进行生成预览并下载XML文件。

### 章节参数设置

  1. **章节数量调整** ：在主控参数区的 “视频章节数量” 输入框中输入所需的章节数并按下回车键，侧边栏将自动更新为对应数量的章节参数块，用户可在这些块中逐一填写各章节的详细信息。
  2. **章节名称填写** ：在每个章节参数块的 “章节名称” 输入框中，输入该章节的名称或标题，名称应简洁明了且具有辨识度，以便在播放设备上能够清晰地标识章节内容。
  3. **时间参数设置** ：对于 “章节开始时间” 和 “章节结束时间” 输入框，用户需按照指定的时间格式（如 “时：分：秒”）输入相应的时间值，准确反映章节在视频中的起止位置，确保播放时能够正确识别到相应章节。
#### 个人在这个功能部分里的逻辑代码编写了纠错功能，在输入时间码时仅识别前六位数字作为时间码，且分隔符除了标准的时间格式所支持的冒号(:)来隔开时间码之外还允许使用小数点(.)、减号(-)进行填写，最终输出的时间码都会进行格式化操作，即将这些符号都替换为冒号(:)，并且移除多余的数字字符与空格，对于单数字则会使用0补全为两位数（示例：输入2.44-6会格式化输出为02:44:06）。

### 文件操作流程

  * **生成 XML 文件** ：完成所有章节参数后设置，点击 “生成章节标签” 按钮，工具将根据当前参数生成符合规范的 XML 格式章节标签文件，并在页面中显示预览内容，预览页面使用开源的[highlight.js](https://highlightjs.org/)组件库来实现XML语法高亮，用户可检查文件的准确性与完整性，完成编辑后如果没有错误还可以双击输出的代码进行一键复制。
  * **下载 XML 文件** ：若对生成的 XML 文件检查没有问题，点击 “下载 XML” 按钮，将文件保存到本地设备，以便后续在视频编辑软件或 MKV 相关工具中使用，或将其混流封装到 MKV 视频文件中实现章节功能。
  * **上传 XML 文件** ：如需对已有的 XML 章节文件进行修改或查看，可点击 “上传 XML” 按钮，选择本地的 XML 文件进行导入，工具会解析文件内容并更新侧边栏的章节参数块，用户可在基础上进行进一步编辑。
#### 此处的上传是指由浏览器进行解析数据进行本地处理。对于上传解析识别“章节结束时间”是智能的，即便没勾选主控制块的“是否启用章节结束时间标签”也会显示在右侧，但是不会输出，因为输出章节结束时间的标签控制是由“是否启用章节结束时间标签”逻辑源码控制的而非上传解析逻辑源码。此功能为测试版，如发现无法上传文件则刷新页面重试即可，且在上传前请先设置主参数，否则上传的数据会被刷新与清除。

## 更新记录
### 第二代版本
  * **v2.2a** ：添加移除与添加侧边参数块功能，通过此处操作将不会重置已有的数据，添加适配语言与浅色与深色模式的切换功能（支持初始化页面时从浏览器检测），进一步优化样式为响应式布局。
  * **v2.1b** ：新增上传XML文件与下载XML文件，目前上传还处于beta阶段，可能出现数据异常，无法上传的异常。
  * **v2.0a** ：重构样式与生成逻辑，添加侧边栏，将所有子参数传入章节参数块，主控添加动态的章节参数块。适配移动端样式。
### 第一代版本
  * **v1.3c** ：结束时间标签此时添加可选状态，默认不启用。添加双击复制所有代码。
  * **v1.2a** ：添加了自定义开始与结束时间的标签。时间输入框默认分隔符可输入小数点与减号进行连接，最后输出会格式化为时间的格式
  * **v1.1a** ：第二代版本，新增了语言标签与参数ID类型为顺序或随机。
  * **v1.0a** ：初版本，只有生成章节与章节数量两个参数。